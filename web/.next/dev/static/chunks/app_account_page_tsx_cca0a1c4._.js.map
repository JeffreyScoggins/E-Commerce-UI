{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/jeff/Code/E-Commerce-UI/web/app/account/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\n\ntype Me = { id: number; username: string; email: string };\n\nexport default function AccountPage() {\n\n  \n  const router = useRouter();\n  const [me, setMe] = useState<Me | null>(null);\n\n  const [email, setEmail] = useState(\"\");\n  const [savingEmail, setSavingEmail] = useState(false);\n\n  const [currentPassword, setCurrentPassword] = useState(\"\");\n  const [newPassword, setNewPassword] = useState(\"\");\n  const [savingPw, setSavingPw] = useState(false);\n\n  const [msg, setMsg] = useState<string>(\"\");\n  const [err, setErr] = useState<string>(\"\");\n\n  useEffect(() => {\n    (async () => {\n      setErr(\"\");\n      const res = await fetch(\"/api/account/me\", { cache: \"no-store\" });\n      if (res.status === 401) {\n        router.replace(\"/login\");\n        return;\n      }\n      if (!res.ok) {\n        setErr(`Failed to load account: ${res.status}`);\n        return;\n      }\n      const data = (await res.json()) as Me;\n      setMe(data);\n      setEmail(data.email ?? \"\");\n    })();\n  }, [router]);\n\n  async function saveEmail(e: React.FormEvent) {\n    e.preventDefault();\n    setMsg(\"\");\n    setErr(\"\");\n    setSavingEmail(true);\n\n    try {\n      const res = await fetch(\"/api/account/me\", {\n        method: \"PATCH\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ email }),\n      });\n      const data = await res.json().catch(() => ({}));\n\n      if (res.status === 401) {\n        router.replace(\"/login\");\n        return;\n      }\n      if (!res.ok) throw new Error(data?.detail || \"Failed to update email.\");\n\n      setMe(data);\n      setMsg(\"Email updated.\");\n    } catch (e: any) {\n      setErr(e?.message || \"Failed to update email.\");\n    } finally {\n      setSavingEmail(false);\n    }\n  }\n\n  async function changePassword(e: React.FormEvent) {\n    e.preventDefault();\n    setMsg(\"\");\n    setErr(\"\");\n    setSavingPw(true);\n\n    try {\n      const res = await fetch(\"/api/account/password\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          current_password: currentPassword,\n          new_password: newPassword,\n        }),\n      });\n      const data = await res.json().catch(() => ({}));\n\n      if (res.status === 401) {\n        router.replace(\"/login\");\n        return;\n      }\n      if (!res.ok) throw new Error(data?.detail || \"Failed to update password.\");\n\n      setCurrentPassword(\"\");\n      setNewPassword(\"\");\n      setMsg(\"Password updated.\");\n    } catch (e: any) {\n      setErr(e?.message || \"Failed to update password.\");\n    } finally {\n      setSavingPw(false);\n    }\n  }\n\n  return (\n    <main className=\"min-h-screen\">\n      <section className=\"mx-auto max-w-3xl px-4 py-8\">\n        <div className=\"rounded-2xl border bg-white p-6 shadow-sm\">\n          <p className=\"text-sm text-zinc-500\">Account</p>\n          <h1 className=\"mt-1 text-2xl font-semibold tracking-tight text-black\">\n            {me ? `Hi, ${me.username}` : \"Your account\"}\n          </h1>\n\n          {msg ? (\n            <div className=\"mt-4 rounded-xl bg-emerald-50 px-3 py-2 text-sm text-emerald-800\">\n              {msg}\n            </div>\n          ) : null}\n          {err ? (\n            <div className=\"mt-4 rounded-xl bg-red-50 px-3 py-2 text-sm text-red-700\">\n              {err}\n            </div>\n          ) : null}\n\n          <div className=\"mt-6 grid gap-6\">\n            <form onSubmit={saveEmail} className=\"rounded-2xl border p-5\">\n              <h2 className=\"text-sm font-semibold text-zinc-900\">Email</h2>\n              <p className=\"mt-1 text-sm text-zinc-600\">\n                Update the email address on your account.\n              </p>\n\n              <label className=\"mt-4 block text-sm font-medium text-zinc-800\">\n                Email address\n              </label>\n              <input\n                className=\"mt-1 w-full rounded-xl border px-3 py-2 outline-none focus:ring-2 focus:ring-zinc-200 text-black\"\n                value={email}\n                onChange={(e) => setEmail(e.target.value)}\n                type=\"email\"\n                required\n              />\n\n              <button\n                type=\"submit\"\n                disabled={savingEmail}\n                className=\"mt-4 rounded-xl bg-zinc-900 px-4 py-2 text-sm font-medium text-white hover:bg-zinc-800 disabled:opacity-60\"\n              >\n                {savingEmail ? \"Saving...\" : \"Save email\"}\n              </button>\n            </form>\n\n            <form onSubmit={changePassword} className=\"rounded-2xl border p-5\">\n              <h2 className=\"text-sm font-semibold text-zinc-900\">Password</h2>\n              <p className=\"mt-1 text-sm text-zinc-600\">\n                Change your password.\n              </p>\n\n              <label className=\"mt-4 block text-sm font-medium text-zinc-800\">\n                Current password\n              </label>\n              <input\n                className=\"mt-1 w-full rounded-xl border px-3 py-2 outline-none focus:ring-2 focus:ring-zinc-200 text-black\"\n                value={currentPassword}\n                onChange={(e) => setCurrentPassword(e.target.value)}\n                type=\"password\"\n                autoComplete=\"current-password\"\n                required\n              />\n\n              <label className=\"mt-4 block text-sm font-medium text-zinc-800\">\n                New password\n              </label>\n              <input\n                className=\"mt-1 w-full rounded-xl border px-3 py-2 outline-none focus:ring-2 focus:ring-zinc-200 text-black\"\n                value={newPassword}\n                onChange={(e) => setNewPassword(e.target.value)}\n                type=\"password\"\n                autoComplete=\"new-password\"\n                minLength={8}\n                required\n              />\n\n              <button\n                type=\"submit\"\n                disabled={savingPw}\n                className=\"mt-4 rounded-xl bg-zinc-900 px-4 py-2 text-sm font-medium text-white hover:bg-zinc-800 disabled:opacity-60\"\n              >\n                {savingPw ? \"Saving...\" : \"Update password\"}\n              </button>\n            </form>\n          </div>\n        </div>\n      </section>\n    </main>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}