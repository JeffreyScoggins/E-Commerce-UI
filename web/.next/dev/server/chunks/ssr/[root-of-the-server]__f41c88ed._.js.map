{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///home/jeff/Code/E-Commerce-UI/web/lib/serverAuth.ts"],"sourcesContent":["import { cookies } from \"next/headers\";\n\nconst ACCESS_COOKIE = \"access_token\";\nconst REFRESH_COOKIE = \"refresh_token\";\n\nexport async function getAccessToken(): Promise<string | undefined> {\n  const jar = await cookies();\n  return jar.get(ACCESS_COOKIE)?.value;\n}\n\nexport async function getRefreshToken(): Promise<string | undefined> {\n  const jar = await cookies();\n  return jar.get(REFRESH_COOKIE)?.value;\n}\n\nexport async function setAuthCookies(access: string, refresh: string) {\n  const jar = await cookies();\n\n  const base = {\n    httpOnly: true,\n    sameSite: \"lax\" as const,\n    path: \"/\",\n    secure: process.env.NODE_ENV === \"production\",\n  };\n\n  jar.set(ACCESS_COOKIE, access, { ...base, maxAge: 60 * 15 });\n  jar.set(REFRESH_COOKIE, refresh, { ...base, maxAge: 60 * 60 * 24 * 7 });\n}\n\nexport async function clearAuthCookies() {\n  const jar = await cookies();\n  jar.delete(ACCESS_COOKIE);\n  jar.delete(REFRESH_COOKIE);\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAEA,MAAM,gBAAgB;AACtB,MAAM,iBAAiB;AAEhB,eAAe;IACpB,MAAM,MAAM,MAAM,IAAA,0IAAO;IACzB,OAAO,IAAI,GAAG,CAAC,gBAAgB;AACjC;AAEO,eAAe;IACpB,MAAM,MAAM,MAAM,IAAA,0IAAO;IACzB,OAAO,IAAI,GAAG,CAAC,iBAAiB;AAClC;AAEO,eAAe,eAAe,MAAc,EAAE,OAAe;IAClE,MAAM,MAAM,MAAM,IAAA,0IAAO;IAEzB,MAAM,OAAO;QACX,UAAU;QACV,UAAU;QACV,MAAM;QACN,QAAQ,oDAAyB;IACnC;IAEA,IAAI,GAAG,CAAC,eAAe,QAAQ;QAAE,GAAG,IAAI;QAAE,QAAQ,KAAK;IAAG;IAC1D,IAAI,GAAG,CAAC,gBAAgB,SAAS;QAAE,GAAG,IAAI;QAAE,QAAQ,KAAK,KAAK,KAAK;IAAE;AACvE;AAEO,eAAe;IACpB,MAAM,MAAM,MAAM,IAAA,0IAAO;IACzB,IAAI,MAAM,CAAC;IACX,IAAI,MAAM,CAAC;AACb"}},
    {"offset": {"line": 66, "column": 0}, "map": {"version":3,"sources":["file:///home/jeff/Code/E-Commerce-UI/web/app/page.tsx"],"sourcesContent":["import { redirect } from \"next/navigation\";\nimport { headers } from \"next/headers\";\nimport { getAccessToken } from \"@/lib/serverAuth\";\n\ntype Product = {\n  id: number;\n  name: string;\n  slug: string;\n  description: string;\n  price_cents: number;\n  currency: string;\n  is_active: boolean;\n  category: { id: number; name: string; slug: string };\n  inventory: null | { quantity: number };\n};\n\nfunction formatPrice(priceCents: number, currency: string) {\n  return new Intl.NumberFormat(\"en-US\", { style: \"currency\", currency }).format(\n    priceCents / 100\n  );\n}\n\nexport default async function HomePage() {\n  const token = await getAccessToken();\n  if (!token) redirect(\"/login\");\n\n  const h = await headers();\n  const host = h.get(\"host\");\n  const proto = process.env.NODE_ENV === \"production\" ? \"https\" : \"http\";\n  if (!host) throw new Error(\"Missing host header\");\n\n  const cookie = h.get(\"cookie\") ?? \"\";\n\n  const res = await fetch(`${proto}://${host}/api/products`, {\n    cache: \"no-store\",\n    headers: { cookie },\n  });\n\n  if (res.status === 401) redirect(\"/login\");\n  if (!res.ok) throw new Error(`Failed to load products: ${res.status}`);\n\n  const products: Product[] = await res.json();\n\n  return (\n    <main className=\"min-h-screen bg-zinc-50\">\n      <header className=\"border-b bg-white\">\n        <div className=\"mx-auto flex max-w-6xl items-center justify-between px-4 py-5\">\n          <div>\n            <p className=\"text-sm text-zinc-500\">Ecommerce Store</p>\n            <h1 className=\"text-2xl font-semibold tracking-tight\">Products</h1>\n          </div>\n\n          <form action=\"/api/auth/logout\" method=\"post\">\n            <button className=\"rounded-xl border bg-white px-3 py-2 text-sm\">\n              Sign out\n            </button>\n          </form>\n        </div>\n      </header>\n\n      <section className=\"mx-auto max-w-6xl px-4 py-8\">\n        <div className=\"grid gap-4 sm:grid-cols-2 lg:grid-cols-3\">\n          {products.map((p) => (\n            <div key={p.id} className=\"rounded-2xl border bg-white p-5 shadow-sm\">\n              <div className=\"flex items-start justify-between gap-3\">\n                <h2 className=\"text-base font-semibold text-zinc-900\">{p.name}</h2>\n                <span className=\"rounded-full border px-2 py-0.5 text-xs text-zinc-700\">\n                  {p.category?.name ?? \"Uncategorized\"}\n                </span>\n              </div>\n\n              <p className=\"mt-2 line-clamp-2 text-sm text-zinc-600\">\n                {p.description || \"No description.\"}\n              </p>\n\n              <div className=\"mt-4 flex items-end justify-between\">\n                <p className=\"text-lg font-semibold text-zinc-900\">\n                  {formatPrice(p.price_cents, p.currency)}\n                </p>\n                <span className=\"rounded-full bg-zinc-100 px-3 py-1 text-xs text-zinc-700\">\n                  {p.is_active ? \"Available\" : \"Inactive\"}\n                </span>\n              </div>\n            </div>\n          ))}\n        </div>\n      </section>\n    </main>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;AAAA;AACA;AACA;;;;;AAcA,SAAS,YAAY,UAAkB,EAAE,QAAgB;IACvD,OAAO,IAAI,KAAK,YAAY,CAAC,SAAS;QAAE,OAAO;QAAY;IAAS,GAAG,MAAM,CAC3E,aAAa;AAEjB;AAEe,eAAe;IAC5B,MAAM,QAAQ,MAAM,IAAA,mIAAc;IAClC,IAAI,CAAC,OAAO,IAAA,iMAAQ,EAAC;IAErB,MAAM,IAAI,MAAM,IAAA,0IAAO;IACvB,MAAM,OAAO,EAAE,GAAG,CAAC;IACnB,MAAM,QAAQ,sCAAwC,0BAAU;IAChE,IAAI,CAAC,MAAM,MAAM,IAAI,MAAM;IAE3B,MAAM,SAAS,EAAE,GAAG,CAAC,aAAa;IAElC,MAAM,MAAM,MAAM,MAAM,GAAG,MAAM,GAAG,EAAE,KAAK,aAAa,CAAC,EAAE;QACzD,OAAO;QACP,SAAS;YAAE;QAAO;IACpB;IAEA,IAAI,IAAI,MAAM,KAAK,KAAK,IAAA,iMAAQ,EAAC;IACjC,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM,CAAC,yBAAyB,EAAE,IAAI,MAAM,EAAE;IAErE,MAAM,WAAsB,MAAM,IAAI,IAAI;IAE1C,qBACE,8OAAC;QAAK,WAAU;;0BACd,8OAAC;gBAAO,WAAU;0BAChB,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;;8CACC,8OAAC;oCAAE,WAAU;8CAAwB;;;;;;8CACrC,8OAAC;oCAAG,WAAU;8CAAwC;;;;;;;;;;;;sCAGxD,8OAAC;4BAAK,QAAO;4BAAmB,QAAO;sCACrC,cAAA,8OAAC;gCAAO,WAAU;0CAA+C;;;;;;;;;;;;;;;;;;;;;;0BAOvE,8OAAC;gBAAQ,WAAU;0BACjB,cAAA,8OAAC;oBAAI,WAAU;8BACZ,SAAS,GAAG,CAAC,CAAC,kBACb,8OAAC;4BAAe,WAAU;;8CACxB,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CAAG,WAAU;sDAAyC,EAAE,IAAI;;;;;;sDAC7D,8OAAC;4CAAK,WAAU;sDACb,EAAE,QAAQ,EAAE,QAAQ;;;;;;;;;;;;8CAIzB,8OAAC;oCAAE,WAAU;8CACV,EAAE,WAAW,IAAI;;;;;;8CAGpB,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CAAE,WAAU;sDACV,YAAY,EAAE,WAAW,EAAE,EAAE,QAAQ;;;;;;sDAExC,8OAAC;4CAAK,WAAU;sDACb,EAAE,SAAS,GAAG,cAAc;;;;;;;;;;;;;2BAjBzB,EAAE,EAAE;;;;;;;;;;;;;;;;;;;;;AA0B1B"}}]
}