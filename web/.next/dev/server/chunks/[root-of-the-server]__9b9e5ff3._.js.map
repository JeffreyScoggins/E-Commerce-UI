{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///home/jeff/Code/E-Commerce-UI/web/app/api/auth/login/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\n\nexport async function POST(req: Request) {\n  const { username, password } = await req.json();\n\n  const base = process.env.DJANGO_API_BASE ?? \"http://127.0.0.1:8000/api\";\n  const r = await fetch(`${base}/auth/token/`, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify({ username, password }),\n    cache: \"no-store\",\n  });\n\n  const data = await r.json().catch(() => ({}));\n\n  if (!r.ok) {\n    return NextResponse.json(\n      { detail: data?.detail ?? \"Login failed\" },\n      { status: r.status }\n    );\n  }\n\n  const access = data?.access as string | undefined;\n  const refresh = data?.refresh as string | undefined;\n\n  if (!access || !refresh) {\n    return NextResponse.json(\n      { detail: \"Token response missing access/refresh\" },\n      { status: 500 }\n    );\n  }\n\n  const res = NextResponse.json({ ok: true });\n\n  const baseCookie = {\n    httpOnly: true,\n    sameSite: \"lax\" as const,\n    path: \"/\",\n    secure: process.env.NODE_ENV === \"production\",\n  };\n\n  res.cookies.set(\"access_token\", access, { ...baseCookie, maxAge: 60 * 15 });\n  res.cookies.set(\"refresh_token\", refresh, { ...baseCookie, maxAge: 60 * 60 * 24 * 7 });\n\n  return res;\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe,KAAK,GAAY;IACrC,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,GAAG,MAAM,IAAI,IAAI;IAE7C,MAAM,OAAO,QAAQ,GAAG,CAAC,eAAe,IAAI;IAC5C,MAAM,IAAI,MAAM,MAAM,GAAG,KAAK,YAAY,CAAC,EAAE;QAC3C,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;YAAE;YAAU;QAAS;QAC1C,OAAO;IACT;IAEA,MAAM,OAAO,MAAM,EAAE,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;IAE3C,IAAI,CAAC,EAAE,EAAE,EAAE;QACT,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,QAAQ,MAAM,UAAU;QAAe,GACzC;YAAE,QAAQ,EAAE,MAAM;QAAC;IAEvB;IAEA,MAAM,SAAS,MAAM;IACrB,MAAM,UAAU,MAAM;IAEtB,IAAI,CAAC,UAAU,CAAC,SAAS;QACvB,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,QAAQ;QAAwC,GAClD;YAAE,QAAQ;QAAI;IAElB;IAEA,MAAM,MAAM,gJAAY,CAAC,IAAI,CAAC;QAAE,IAAI;IAAK;IAEzC,MAAM,aAAa;QACjB,UAAU;QACV,UAAU;QACV,MAAM;QACN,QAAQ,oDAAyB;IACnC;IAEA,IAAI,OAAO,CAAC,GAAG,CAAC,gBAAgB,QAAQ;QAAE,GAAG,UAAU;QAAE,QAAQ,KAAK;IAAG;IACzE,IAAI,OAAO,CAAC,GAAG,CAAC,iBAAiB,SAAS;QAAE,GAAG,UAAU;QAAE,QAAQ,KAAK,KAAK,KAAK;IAAE;IAEpF,OAAO;AACT"}}]
}